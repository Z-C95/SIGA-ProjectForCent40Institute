{% extends "layouts/base_auth.html" %}
{% load static %}
{% block title %}Restablecer contraseña — SIGA{% endblock %}

{% block content %}

<div class="text-center mb-4">
  <img src="{% static 'img/siga_logo.png' %}"
       alt="SIGA — Gestión Académica"
       style="width: 90px; border-radius: 12px;">
  <h1 class="h5 mt-3 mb-0">Restablecer contraseña</h1>
</div>

<div class="card shadow-sm border-0">
  <div class="card-body p-4">

    {% if validlink %}

      <form method="post"
            action=""
            style="max-width: 380px; margin: 0 auto;">
        {% csrf_token %}

        {{ form.non_field_errors }}

        <div class="mb-3">
          <label class="form-label d-block text-start">Nueva contraseña</label>
          {{ form.new_password1 }}
          {% if form.new_password1.errors %}
            <div class="text-danger small mt-1">
              {{ form.new_password1.errors }}
            </div>
          {% endif %}
        </div>

        <div class="mb-3">
          <label class="form-label d-block text-start">Confirmar contraseña</label>
          {{ form.new_password2 }}
          {% if form.new_password2.errors %}
            <div class="text-danger small mt-1">
              {{ form.new_password2.errors }}
            </div>
          {% endif %}
        </div>

        <button type="submit" class="btn btn-primary w-100">
          Guardar nueva contraseña
        </button>

        <div class="text-center mt-3">
          <a href="{% url 'login' %}">← Volver al inicio de sesión</a>
        </div>
      </form>

    {% else %}

      <div class="text-center">
        <p class="mb-2">
          El enlace de restablecimiento de contraseña no es válido
          o ya fue utilizado.
        </p>
        <p class="text-muted small mb-4">
          Podés solicitar un nuevo enlace de recuperación.
        </p>

        <a href="{% url 'asistencias:password_reset' %}" class="btn btn-primary w-100 mb-2">
          Solicitar un nuevo enlace
        </a>

        <a href="{% url 'login' %}">← Volver al inicio de sesión</a>
      </div>

    {% endif %}

  </div>
</div>

{% endblock %}
